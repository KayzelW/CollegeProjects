Протестированный C код на onlinegdb: https://onlinegdb.com/CJlUMRlhS